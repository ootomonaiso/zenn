---
title: "Cisco Modeling Labs(CML)のインストールをVMware ESXi上に構築する"
emoji: "😸"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["vmware","cml"]
published: false
---

## CMLとは?
CMLとはciscoが提供しているネットワーク設計やテストができる仮想化された環境を提供してくれるプラットフォームです。Ubuntu上に動作しています。CMLを起動するとWebUIとして実際にネットワーク機器の配置や設定を行うためのページと、管理者用のCML自体の設定をするページが動作します。管理者用のページはCUIとして実際に動いているマシン上に動作します。

## 環境
- VMware ESXi v7.03
> 記事作成時には既にVMware ESXiバージョン8が公開されています。恐らく大きな問題はないかと思います
- CML v2.8.x

## CMlの必要環境
- ESXi v7.0以降
- 

## 環境構築のやり方
既にESXiはインストールされている状態から始めていきます

### CMLのインストール用のファイルを取得する
#### ciscoのアカウントを作成する
[無料版のCisco Modeling Labs](https://mkto.cisco.com/cml-free.html)はここから登録してください
無料版のCMLのインストール用のファイルの取得にはciscoのアカウントが必要です
 [ciscoのアカウント作成ページ](https://id.cisco.com/signin/register)へアクセスしてアカウント作ってください。

#### ファイルのダウンロード
アカウントができると登録したメールアドレス宛にメールが届きます。届いてない場合は迷惑メールなども確認してください。
[メールの中にあるCMLのダウンロードページ](https://software.cisco.com/download/home/286193282/type/286326381/release/CML-Free?mkt_tok=NTY0LVdIVi0zMjMAAAGaKZwwosvxyRt0ifDU443RG8q_dY9yET75OqLaReeR_02pia7AtJjNb4bzkGngf13IilaTY3_e46tEjbqIshbXeIyvpmybEqozvIwDETFU4BsLZ1hR) へ飛んでください

遷移先のページには4つのファイルがあります。ESXiで構築する場合、
- 拡張子が `.ova` のファイル
- `refplat-年月日-freetier-iso.zip`
の2つを取得してください。一番上のisoはマシンに直接入れる用です。

## CMLをインストールする
ESXiのWebUIを開いて、**仮想マシンを作成/登録**から作成していきます

### 1.作成タイプをOVFまたはOVAファイルからに変更
![OVFファイルのものへ変更したよ](https://storage.googleapis.com/zenn-user-upload/ff2cafcc9db2-20250717.png)
上から`2番目のOVFファイルまたはOVAファイルから仮想マシンをデプロイ`に変更します。できたら次へを選択してください。

### 2.OVAファイルをアップロード
![OVAアップロード画面](https://storage.googleapis.com/zenn-user-upload/0a7af48dadfa-20250717.png)
ダウンロードしてきたOVAファイルをドラックアンドドロップまたはエクスプローラから選択します。ESXiにアップロードしてある必要はないです。

### 3.ストレージの選択
32GB以上あれば大抵大丈夫だと思います。ルーターを追加するたびにIOSのコンテナを生成しているらしく、大規模なネットワークや同じCMLを学習用に使いこむ予定がある人はだいぶ多めに見積もってください。

### 4.デプロイオプションの設定
![オプション](https://storage.googleapis.com/zenn-user-upload/1523e1970cba-20250718.png)
ディスク プロビジョニングは **シン** に、ネットワークマッピングはお好みのポートグループを指定してください。インターネットに出なくても動作します。

次へを押すと設定の確認が入ります。大丈夫そうなら完了を押してください

### 5.isoのマウント
isoをマウントします。`refplat-年月日-freetier-iso.zip`を解凍してESXiにアップロードしておいてください。
先ほど作った仮想マシンを開いて設定の編集をします。
![isoのマウント手順](https://storage.googleapis.com/zenn-user-upload/818da267693a-20250718.png)

なお当方の環境ではここでマウントしてもインストール時にマウントされてない判定が出てインストールできなかったため、VMRC上からマウントしなおしてました。

設定の編集からCD/DVDドライブをホストデバイスから**データストアISOファイル**へ切り替えて、`refplat-年月日-freetier-iso`を選択してマウントしてください。

### 5.インストール画面をひらく
CML²の表示があるGUIの画面に飛べば正常。Continueを選択。

### 6.EULAをながめる

![eula](https://storage.googleapis.com/zenn-user-upload/47060a891c32-20250718.png)
EULAを眺めます。矢印キーでEULAを上下できます。満足したらTabキーを押して **Accept EULA** にカーソルを移してエンターキーを押してください。

次にファーストデプロイメント設定をはじめます下に日本語訳を添えておきました
```
CML^2 の最初のデプロイメント構成へようこそ。

システムを使用する前に、システムの展開スタイル、ネットワーク、および 1 つまたは 2 つのアカウントを構成する必要があります。

デプロイメント スタイルはスタンドアロン構成とクラスター構成の間で切り替わり、CML Enterprise のお客様がご利用いただけます。

管理用の特権 Linux システム ユーザー アカウントは、ポート 9090 の HTTPS 経由で Cockpit UI にアクセスできます。

このシステムが追加のクラスター コンピューティング ホストでない限り、管理コントローラー ユーザーを、ポート 443 の HTTPS 経由でアクセス可能な Web UI にログインするように構成する必要があります。
```
![11111](https://storage.googleapis.com/zenn-user-upload/d83acb80ee4a-20250718.png)

